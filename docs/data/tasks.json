{
  "tasks": [
    {
      "id": "ac970a36-d87f-40ab-846b-527cf7ab9729",
      "name": "Restore Turnstile widget integration",
      "description": "Expose success/error handlers on TurnstileWidget so LazyTurnstile can propagate tokens, and document env configuration for provided site/secret keys without hardcoding secrets.",
      "notes": "Do not commit actual secret values; provide .env.example guidance only.",
      "status": "completed",
      "dependencies": [],
      "createdAt": "2025-11-02T06:31:11.306Z",
      "updatedAt": "2025-11-02T06:40:49.262Z",
      "relatedFiles": [
        {
          "path": "src/components/security/turnstile.tsx",
          "type": "TO_MODIFY",
          "description": "Expose correct handler props"
        },
        {
          "path": "src/components/forms/contact-form-container.tsx",
          "type": "TO_MODIFY",
          "description": "Adjust LazyTurnstile usage"
        },
        {
          "path": "docs",
          "type": "REFERENCE",
          "description": "Update environment documentation if applicable"
        }
      ],
      "implementationGuide": "1. Inspect src/components/security/turnstile.tsx and ensure TurnstileWidget accepts onSuccess/onError/onExpire/onLoad, forwarding to @marsidev/react-turnstile.\n2. Update LazyTurnstile usage in src/components/forms/contact-form-container.tsx to match new props (or rename calls to onVerify).\n3. Confirm types align with Turnstile library definitions; extend local TurnstileProps interface if needed.\n4. Add README/env instructions referencing NEXT_PUBLIC_TURNSTILE_SITE_KEY and TURNSTILE_SECRET_KEY (without leaking values).\n5. Run `pnpm type-check` after changes.",
      "verificationCriteria": "`pnpm type-check` passes without Turnstile typedef errors.",
      "summary": "Turnstile wrapper now accepts onSuccess alongside onVerify so LazyTurnstile propagates tokens correctly, documentation covers configuring NEXT_PUBLIC_TURNSTILE_SITE_KEY and TURNSTILE_SECRET_KEY, and `pnpm type-check` succeeds without prop typing errors.",
      "completedAt": "2025-11-02T06:40:49.260Z"
    },
    {
      "id": "33771e7d-45e5-44ff-9db7-f77ecaaf5231",
      "name": "Fix contact form rate-limit reset",
      "description": "Ensure ContactFormContainer re-enables submission after Turnstile success and cooldown expiry so submission button state matches tests.",
      "status": "completed",
      "dependencies": [
        {
          "taskId": "ac970a36-d87f-40ab-846b-527cf7ab9729"
        }
      ],
      "createdAt": "2025-11-02T06:31:11.306Z",
      "updatedAt": "2025-11-02T07:14:46.019Z",
      "relatedFiles": [
        {
          "path": "src/components/forms/contact-form-container.tsx",
          "type": "TO_MODIFY",
          "description": "Adjust form state logic"
        },
        {
          "path": "src/components/forms/__tests__/contact-form-submission.test.tsx",
          "type": "TO_MODIFY",
          "description": "Ensure tests reflect new behavior"
        }
      ],
      "implementationGuide": "1. Review useContactForm logic for turnstileToken, lastSubmissionTime, and isRateLimited.\n2. After successful verification set token and schedule cooldown reset (clear turnstileToken appropriately).\n3. Consider using setTimeout or effect watching lastSubmissionTime to toggle isRateLimited flag.\n4. Update tests/mocks as needed to cover both immediate enable and cooldown expiry.\n5. Re-run targeted unit tests.",
      "verificationCriteria": "`pnpm test --filter contact-form-submission` succeeds and submit button state assertions pass.",
      "summary": "Implemented rate-limit reset scheduling with an overridable cooldown timer and expanded contact form tests; pnpm test src/components/forms/__tests__/contact-form-submission.test.tsx passed validating button state transitions.",
      "completedAt": "2025-11-02T07:14:46.018Z"
    },
    {
      "id": "e0062adf-8d52-4773-9d4a-8dd1135d0dd9",
      "name": "Align company field requirement",
      "description": "Resolve mismatch between validationConfig.requiredFields and UI/tests by confirming business rule for company field and applying consistent updates.",
      "status": "completed",
      "dependencies": [],
      "createdAt": "2025-11-02T06:31:11.306Z",
      "updatedAt": "2025-11-02T06:56:05.988Z",
      "relatedFiles": [
        {
          "path": "src/lib/validations.ts",
          "type": "TO_MODIFY",
          "description": "Update validationConfig"
        },
        {
          "path": "src/lib/__tests__/validations.test.ts",
          "type": "TO_MODIFY",
          "description": "Adjust assertions"
        },
        {
          "path": "src/components/forms/fields/contact-fields.tsx",
          "type": "TO_MODIFY",
          "description": "Toggle required indicator"
        }
      ],
      "implementationGuide": "1. Confirm with product/design whether company is mandatory.\n2. If required: add 'company' to validationConfig.requiredFields, mark Input required, update translations/tests.\n3. If optional: update validations.test.ts expectations to exclude it and document reasoning.\n4. Ensure Airtable schema and API validators remain consistent.\n5. Re-run relevant validation tests.",
      "verificationCriteria": "`pnpm test --filter validations` passes with agreed requirement and UI matches copy.",
      "summary": "Company field is now required across validation schema, UI, and tests; pnpm test src/lib/__tests__/validations.test.ts passed to confirm the updated rule.",
      "completedAt": "2025-11-02T06:56:05.988Z"
    },
    {
      "id": "77d202fa-1f37-478c-a6a4-ea124b3ae3fa",
      "name": "Relax HeroSection test message typing",
      "description": "Allow HeroSection tests to supply fallback empty strings without TypeScript literal constraint failures.",
      "status": "completed",
      "dependencies": [],
      "createdAt": "2025-11-02T06:31:11.306Z",
      "updatedAt": "2025-11-02T07:00:54.673Z",
      "relatedFiles": [
        {
          "path": "src/components/home/hero-section.tsx",
          "type": "TO_MODIFY",
          "description": "Define message types"
        },
        {
          "path": "src/components/home/__tests__/hero-section.test.tsx",
          "type": "TO_MODIFY",
          "description": "Adopt relaxed typing"
        }
      ],
      "implementationGuide": "1. Introduce explicit HeroSection message interface or utility type with optional fields in src/components/home/hero-section.tsx (and exported static variant).\n2. Update tests to use the new type instead of Partial<typeof mockMessages>.\n3. Ensure runtime behavior unchanged; only typings should relax.\n4. Re-run hero-section test suites.",
      "verificationCriteria": "`pnpm type-check:tests` and `pnpm test --filter hero-section` both succeed.",
      "summary": "Relaxed HeroSection message typing via new HeroSectionMessages interface and test updates; pnpm type-check:tests and pnpm test src/components/home/__tests__/hero-section.test.tsx both succeeded.",
      "completedAt": "2025-11-02T07:00:54.671Z"
    },
    {
      "id": "12b6517a-706f-45f5-a9ca-4656d3b9dc80",
      "name": "Refactor verifyTurnstile for lint compliance",
      "description": "Reduce statements in verifyTurnstile to satisfy ESLint max-statements and maintain error handling/logging behavior.",
      "status": "completed",
      "dependencies": [
        {
          "taskId": "ac970a36-d87f-40ab-846b-527cf7ab9729"
        }
      ],
      "createdAt": "2025-11-02T06:31:11.306Z",
      "updatedAt": "2025-11-02T07:20:49.020Z",
      "relatedFiles": [
        {
          "path": "src/app/api/contact/contact-api-utils.ts",
          "type": "TO_MODIFY",
          "description": "Refactor verifyTurnstile"
        }
      ],
      "implementationGuide": "1. Break verifyTurnstile into helper functions (buildPayload, parseResponse, validateHostname).\n2. Share logging utilities via existing logger.\n3. Ensure helpers remain in same module for easy import.\n4. Run lint to confirm rule satisfied.",
      "verificationCriteria": "`pnpm lint:check` reports zero max-statements violations.",
      "summary": "Refactored verifyTurnstile into modular helpers for payload creation, response validation, and logging; pnpm lint:check now passes without max-statement violations.",
      "completedAt": "2025-11-02T07:20:49.019Z"
    },
    {
      "id": "391fdbe9-97ca-4e31-ac0a-152a41c439f1",
      "name": "Repair quality gate tooling",
      "description": "Fix scripts/quality-gate.js and scripts/quality-monitor.js to parse ESLint output correctly and avoid '--format' glob errors.",
      "status": "completed",
      "dependencies": [
        {
          "taskId": "12b6517a-706f-45f5-a9ca-4656d3b9dc80"
        }
      ],
      "createdAt": "2025-11-02T06:31:11.306Z",
      "updatedAt": "2025-11-02T07:29:43.775Z",
      "relatedFiles": [
        {
          "path": "scripts/quality-gate.js",
          "type": "TO_MODIFY",
          "description": "Handle ESLint output safely"
        },
        {
          "path": "scripts/quality-monitor.js",
          "type": "TO_MODIFY",
          "description": "Fix CLI invocation"
        }
      ],
      "implementationGuide": "1. Update child process invocations to pass CLI options as separate arguments.\n2. Parse ESLint results via JSON (JSON.parse) and guard for non-string returns.\n3. Confirm failures produce actionable messages without throwing.\n4. Document usage expectations in scripts README if needed.",
      "verificationCriteria": "`pnpm quality:gate` and `pnpm quality:monitor` complete without runtime errors.",
      "summary": "Reworked quality gate/monitor scripts to invoke ESLint via spawn with JSON parsing and resilient error handling; pnpm quality:gate and pnpm quality:monitor now complete without runtime failures.",
      "completedAt": "2025-11-02T07:29:43.774Z"
    },
    {
      "id": "5ec32c17-c9fb-486c-be38-fd6033edd00c",
      "name": "Full regression verification",
      "description": "After fixes, run comprehensive checks to ensure pipeline is green and document remaining warnings for follow-up.",
      "status": "in_progress",
      "dependencies": [
        {
          "taskId": "ac970a36-d87f-40ab-846b-527cf7ab9729"
        },
        {
          "taskId": "33771e7d-45e5-44ff-9db7-f77ecaaf5231"
        },
        {
          "taskId": "e0062adf-8d52-4773-9d4a-8dd1135d0dd9"
        },
        {
          "taskId": "77d202fa-1f37-478c-a6a4-ea124b3ae3fa"
        },
        {
          "taskId": "12b6517a-706f-45f5-a9ca-4656d3b9dc80"
        },
        {
          "taskId": "391fdbe9-97ca-4e31-ac0a-152a41c439f1"
        }
      ],
      "createdAt": "2025-11-02T06:31:11.306Z",
      "updatedAt": "2025-11-02T07:31:02.213Z",
      "relatedFiles": [],
      "implementationGuide": "1. Execute `pnpm type-check`, `pnpm type-check:tests`, `pnpm lint:check`, `pnpm test`, `pnpm test:coverage`, `pnpm size:check`, `pnpm test:e2e`, `pnpm quality:gate`.\n2. Capture key outputs (pass/fail, coverage, size).\n3. Summarize residual warnings (Radix accessibility, knip findings) for backlog.",
      "verificationCriteria": "All listed commands succeed; report documents status and outstanding warnings."
    },
    {
      "id": "819d0b8a-3d5a-4437-9464-e9850671580a",
      "name": "Execute Align company field requirement",
      "description": "Implement the business decision for the company field across validation config, UI indicator, and unit tests to align behaviour",
      "status": "pending",
      "dependencies": [],
      "createdAt": "2025-11-02T06:51:05.476Z",
      "updatedAt": "2025-11-02T06:51:05.476Z",
      "relatedFiles": [
        {
          "path": "src/lib/validations.ts",
          "type": "TO_MODIFY",
          "description": "Align required fields list"
        },
        {
          "path": "src/components/forms/fields/contact-fields.tsx",
          "type": "TO_MODIFY",
          "description": "Toggle required indicator"
        },
        {
          "path": "src/lib/__tests__/validations.test.ts",
          "type": "TO_MODIFY",
          "description": "Update test assertions"
        }
      ],
      "implementationGuide": "Inspect src/lib/validations.ts, adjust requiredFields and exports; update src/components/forms/fields/contact-fields.tsx to reflect required state and label; sync expectations in src/lib/__tests__/validations.test.ts; ensure translations/messages remain consistent",
      "verificationCriteria": "pnpm test --filter validations passes with the agreed company field rule"
    },
    {
      "id": "26fe19f5-2827-40dc-ac9f-11f2e88178ea",
      "name": "Execute Relax HeroSection message typing",
      "description": "Loosen HeroSection message types so tests can supply empty strings without literal constraint failures",
      "status": "pending",
      "dependencies": [],
      "createdAt": "2025-11-02T06:51:05.476Z",
      "updatedAt": "2025-11-02T06:51:05.476Z",
      "relatedFiles": [
        {
          "path": "src/components/home/hero-section.tsx",
          "type": "TO_MODIFY",
          "description": "Adjust message props typing"
        },
        {
          "path": "src/components/home/__tests__/hero-section.test.tsx",
          "type": "TO_MODIFY",
          "description": "Use relaxed type in tests"
        }
      ],
      "implementationGuide": "Review message typing in src/components/home/hero-section.tsx, introduce optional-friendly interface or utility, export updated type; update src/components/home/__tests__/hero-section.test.tsx to consume new type; ensure runtime behaviour unaffected",
      "verificationCriteria": "pnpm type-check:tests and pnpm test --filter hero-section both succeed"
    },
    {
      "id": "a9064c4f-78ed-4288-8fca-24def5fce579",
      "name": "Execute Fix contact form rate-limit reset",
      "description": "Update ContactFormContainer logic so submission is re-enabled after Turnstile success and cooldown expiry",
      "status": "pending",
      "dependencies": [
        {
          "taskId": "819d0b8a-3d5a-4437-9464-e9850671580a"
        },
        {
          "taskId": "26fe19f5-2827-40dc-ac9f-11f2e88178ea"
        }
      ],
      "createdAt": "2025-11-02T06:51:05.476Z",
      "updatedAt": "2025-11-02T06:51:05.476Z",
      "relatedFiles": [
        {
          "path": "src/components/forms/contact-form-container.tsx",
          "type": "TO_MODIFY",
          "description": "Adjust rate-limit logic"
        },
        {
          "path": "src/components/forms/__tests__/contact-form-submission.test.tsx",
          "type": "TO_MODIFY",
          "description": "Align tests with new behaviour"
        }
      ],
      "implementationGuide": "Inspect useContactForm state for turnstile token and rate limit; ensure cooldown resets state and token; extend tests in src/components/forms/__tests__/contact-form-submission.test.tsx to cover expected button state; rerun targeted tests",
      "verificationCriteria": "pnpm test --filter contact-form-submission passes with correct button state"
    },
    {
      "id": "5dca965b-79f6-4494-9d85-853478c2e97a",
      "name": "Execute Refactor verifyTurnstile",
      "description": "Break down verifyTurnstile into helpers to satisfy ESLint max-statements without changing behaviour",
      "status": "pending",
      "dependencies": [
        {
          "taskId": "a9064c4f-78ed-4288-8fca-24def5fce579"
        }
      ],
      "createdAt": "2025-11-02T06:51:05.476Z",
      "updatedAt": "2025-11-02T06:51:05.476Z",
      "relatedFiles": [
        {
          "path": "src/app/api/contact/contact-api-utils.ts",
          "type": "TO_MODIFY",
          "description": "Refactor verifyTurnstile"
        }
      ],
      "implementationGuide": "Refactor src/app/api/contact/contact-api-utils.ts by extracting helper functions for payload creation, response parsing, and hostname validation; reuse logger; ensure error paths preserved",
      "verificationCriteria": "pnpm lint:check completes without max-statements violations"
    },
    {
      "id": "62ab8c92-4040-4250-862c-b08fbbfcfd66",
      "name": "Execute Repair quality gate tooling",
      "description": "Update ESLint tooling scripts to avoid glob errors and parse output reliably",
      "status": "pending",
      "dependencies": [
        {
          "taskId": "5dca965b-79f6-4494-9d85-853478c2e97a"
        }
      ],
      "createdAt": "2025-11-02T06:51:05.476Z",
      "updatedAt": "2025-11-02T06:51:05.476Z",
      "relatedFiles": [
        {
          "path": "scripts/quality-gate.js",
          "type": "TO_MODIFY",
          "description": "Fix argument handling and parsing"
        },
        {
          "path": "scripts/quality-monitor.js",
          "type": "TO_MODIFY",
          "description": "Align CLI invocation and parsing"
        }
      ],
      "implementationGuide": "Adjust scripts/quality-gate.js and scripts/quality-monitor.js to pass CLI args as arrays, parse JSON output with guards, and provide actionable error messages",
      "verificationCriteria": "pnpm quality:gate and pnpm quality:monitor run without runtime errors"
    },
    {
      "id": "2f9fa400-1471-43c8-9fc8-f1e85767d932",
      "name": "Execute Full regression verification",
      "description": "Run full quality pipeline after fixes and summarize outstanding warnings",
      "status": "pending",
      "dependencies": [
        {
          "taskId": "62ab8c92-4040-4250-862c-b08fbbfcfd66"
        }
      ],
      "createdAt": "2025-11-02T06:51:05.476Z",
      "updatedAt": "2025-11-02T06:51:05.476Z",
      "relatedFiles": [],
      "implementationGuide": "Run pnpm type-check, type-check:tests, lint:check, test, test:coverage, size:check, test:e2e, quality:gate; collect outputs and document remaining warnings",
      "verificationCriteria": "All regression commands succeed and summary is documented"
    }
  ]
}